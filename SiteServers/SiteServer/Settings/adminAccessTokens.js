var $apiUrl=$apiConfig.apiUrl,$api=new apiUtils.Api($apiUrl+"/pages/settings/adminAccessTokens"),data={pageLoad:!1,pageAlert:{type:"warning",html:'API密钥可以用于访问 SiteServer REST API <a href="https://docs.siteserver.cn/api/" target="_blank">阅读更多</a>'},pageType:null,items:null,adminNames:null,scopes:null,adminName:null,item:null},methods={getList:function(){var e=this;$api.get(null,function(i,t){!i&&t&&t.value&&(e.items=t.value,e.adminNames=t.adminNames,e.scopes=t.scopes,e.adminName=t.adminName,e.pageLoad=!0)})},getItemScopes:function(e){if(!e.scopes)return"";for(var i=e.scopes.split(","),t=[],s=0;s<this.scopes.length;s++)-1!==i.indexOf(this.scopes[s])&&t.push(this.scopes[s]);return t.join(",")},delete:function(e){var i=this;pageUtils.loading(!0),$api.delete({id:e.id},function(e,t){pageUtils.loading(!1),!e&&t&&t.value&&(i.items=t.value)})},submit:function(e){var i=this;this.item.scopes=this.item.scopeList?this.item.scopeList.join(","):"",pageUtils.loading(!0),$api.post(e,function(t,s){if(pageUtils.loading(!1),t)return void(i.pageAlert={type:"danger",html:t.message});i.pageAlert={type:"success",html:e.id?"API密钥修改成功！":"API密钥添加成功！"},i.item=null,i.items=s.value,i.pageType="list"})},btnAddClick:function(e){this.pageType="add",this.item=e,this.item.adminName=this.item.adminName?this.item.adminName:this.adminName,this.item.scopeList=this.item.scopes?this.item.scopes.split(","):[]},btnSubmitClick:function(){this.submit(this.item)},btnCancelClick:function(){this.pageType="list"},btnViewClick:function(e){pageUtils.openLayer({title:"获取密钥",url:"adminAccessTokensViewLayer.cshtml?id="+e.id,height:410})},btnDeleteClick:function(e){var i=this;pageUtils.alertDelete({title:"删除API密钥",text:"此操作将删除API密钥 "+e.title+"，确定吗？",callback:function(){i.delete(e),this.pageType="list"}})}},$vue=new Vue({el:"#main",data:data,methods:methods});$vue.getList();
var $api=new utils.Api("/home/contents");Object.defineProperty(Object.prototype,"getProp",{value:function(e){var t;for(t in this)if(t.toLowerCase()==e.toLowerCase())return this[t]}});var data={pageConfig:null,pageLoad:!1,pageAlert:null,pageType:null,page:1,pageContents:[],count:null,pages:null,sites:[],channels:[],site:{},channel:{},permissions:{},columns:null,pageOptions:null,isAllChecked:!1},methods={load:function(e,t,n,i,s){this.pageConfig=e,this.sites=t,this.channels=n,this.loadChannel(i,s)},loadChannel:function(e,t){this.site=e,this.channel=t,this.site&&this.channel?(Cookies.set("SS-USER-SITE-ID",this.site.id,{expires:7}),Cookies.set("SS-USER-CHANNEL-ID",this.channel.id,{expires:7}),this.loadContents(1)):this.pageType="Unauthorized"},btnAddClick:function(){parent.location.hash="pages/contentAdd.html?siteId="+this.site.id+"&channelId="+this.channel.id+"&returnUrl="+encodeURIComponent(parent.location.hash)},btnEditClick:function(e){parent.location.hash="pages/contentAdd.html?siteId="+this.site.id+"&channelId="+this.channel.id+"&contentId="+e+"&returnUrl="+encodeURIComponent(parent.location.hash)},btnLayerClick:function(e){event.stopPropagation(),this.pageAlert=null;var t="pages/contentsLayer"+e.name+".html?siteId="+this.site.id+"&channelId="+this.channel.id;if(e.withContents){if(0===this.selectedContentIds.length)return;t+="&contentIds="+this.selectedContentIds.join(",")}else e.contentId&&(t+="&contentId="+e.contentId);t+="&returnUrl="+encodeURIComponent(parent.location.hash),parent.utils.openLayer({title:e.title,url:t,full:e.full,width:e.width?e.width:700,height:e.height?e.height:500})},toggleChecked:function(e){e.isSelected=!e.isSelected,e.isSelected||(this.isAllChecked=!1)},selectAll:function(){this.isAllChecked=!this.isAllChecked;for(var e=0;e<this.pageContents.length;e++)this.pageContents[e].isSelected=this.isAllChecked},loadFirstPage:function(){1!==this.page&&this.loadContents(1)},loadPrevPage:function(){this.page-1<=0||this.loadContents(this.page-1)},loadNextPage:function(){this.page+1>this.pages||this.loadContents(this.page+1)},loadLastPage:function(){this.page+1>this.pages||this.loadContents(this.pages)},onSiteSelect(e){if(e.id!==this.site.id){var t=this;this.pageLoad=!1,utils.getConfig({pageName:"contents",siteId:e.id},function(e){t.pageLoad=!0,t.load(e.value,e.sites,e.channels,e.site,e.channel)})}},onChannelSelect(e){e.id!==this.channel.id&&(this.loadChannel(this.site,e),this.loadContents(1))},onPageSelect(e){this.loadContents(e)},loadContents:function(e){var t=this;t.pageLoad&&parent.utils.loading(!0),$api.get({siteId:t.site.id,channelId:t.channel.id,page:e},function(n,i){if(t.pageLoad?(parent.utils.loading(!1),parent.utils.scrollToTop()):t.pageLoad=!0,n)t.pageAlert={type:"danger",html:n.message};else{t.permissions=i.permissions,t.columns=i.columns;for(var s=[],a=0;a<i.value.length;a++){var o=_.assign({},i.value[a],{isSelected:!1});s.push(o)}t.pageContents=s,t.count=i.count,t.pages=i.pages,t.page=e,t.pageOptions=[];for(a=1;a<=t.pages;a++)t.pageOptions.push(a)}})}};Vue.component("multiselect",window.VueMultiselect.default);var $vue=new Vue({el:"#main",data:data,methods:methods,computed:{selectedContentIds:function(){var e=[];if(this.pageContents)for(var t=0;t<this.pageContents.length;t++)this.pageContents[t].isSelected&&e.push(this.pageContents[t].id);return e}},created:function(){var e=this,t=parseInt(utils.getQueryString("siteId")||Cookies.get("SS-USER-SITE-ID")||0),n=parseInt(utils.getQueryString("channelId")||Cookies.get("SS-USER-CHANNEL-ID")||0);utils.getConfig({pageName:"contents",siteId:t,channelId:n},function(t){t.value?e.load(t.config,t.sites,t.channels,t.site,t.channel):utils.redirectLogin()})}});
var $api=new utils.Api("/home/contentsLayerWord"),$uploadUrl=utils.getApiUrl("/home/contentsLayerWord"),data={siteId:parseInt(utils.getQueryString("siteId")),channelId:parseInt(utils.getQueryString("channelId")),returnUrl:utils.getQueryString("returnUrl"),pageLoad:!1,pageAlert:null,file:null,files:[],isFirstLineTitle:!1,isFirstLineRemove:!0,isClearFormat:!0,isFirstLineIndent:!0,isClearFontSize:!0,isClearFontFamily:!0,isClearImages:!1,checkedLevels:null,checkedLevel:null},methods={loadConfig:function(){var e=this;e.pageLoad=!0,$api.get({siteId:e.siteId,channelId:e.channelId},function(t,i){!t&&i&&i.value&&(e.checkedLevels=i.value,e.checkedLevel=i.checkedLevel,e.loadUploader())})},loadUploader:function(){var e=this,t=Q.event,i=Q.Uploader,n=document.getElementById("drop-area"),l=new i({url:$uploadUrl+"/actions/upload?siteId="+e.siteId+"&channelId="+e.channelId+"&userToken="+utils.getToken(),target:document.getElementById("drop-area"),allows:".doc,.docx",on:{add:function(e){if(e.disabled)return alert({title:"文件错误！",text:"允许上传的文件格式为："+this.ops.allows,type:"error",showConfirmButton:!1})},complete:function(t){var i=t.json;if(!i||1!=i.ret)return alert({title:"Word 文件上传失败！",type:"error",showConfirmButton:!1});i&&i.fileName&&e.files.push(i)}}});i.support.html5&&l.html5?(t.add(n,"dragleave",t.stop),t.add(n,"dragenter",t.stop),t.add(n,"dragover",t.stop),t.add(n,"drop",function(e){t.stop(e);var i=e.dataTransfer.files;l.addList(i)})):n.innerHTML="点击批量上传Word文件"},del:function(e){this.files.splice(this.files.indexOf(e),1)},getFileNames:function(){for(var e=[],t=0;t<this.files.length;t++)e.push(this.files[t].fileName);return e},btnSubmitClick:function(){var e=this,t=this.getFileNames().join(",");if(!t)return alert({title:"请选择需要导入的Word文件！",type:"warning",showConfirmButton:!1});parent.utils.loading(!0),$api.post({siteId:e.siteId,channelId:e.channelId,isFirstLineTitle:e.isFirstLineTitle,isFirstLineRemove:e.isFirstLineRemove,isClearFormat:e.isClearFormat,isFirstLineIndent:e.isFirstLineIndent,isClearFontSize:e.isClearFontSize,isClearFontFamily:e.isClearFontFamily,isClearImages:e.isClearImages,checkedLevel:e.checkedLevel,fileNames:t},function(t,i){if(!t&&i&&i.value){parent.layer.closeAll();var n=i.value;1===n.length?parent.location.hash="pages/contentAdd.html?siteId="+e.siteId+"&channelId="+e.channelId+"&contentId="+n[0]+"&returnUrl="+encodeURIComponent(e.returnUrl):parent.location.reload(!0)}})}};new Vue({el:"#main",data:data,methods:methods,created:function(){this.loadConfig()}});
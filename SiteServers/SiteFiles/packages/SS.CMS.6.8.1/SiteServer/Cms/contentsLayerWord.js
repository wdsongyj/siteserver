var $api=new apiUtils.Api(apiUrl+"/pages/cms/contentsLayerWord"),$uploadUrl=apiUrl+"/pages/cms/contentsLayerWord",data={siteId:parseInt(pageUtils.getQueryStringByName("siteId")),channelId:parseInt(pageUtils.getQueryStringByName("channelId")),pageLoad:!1,pageAlert:null,file:null,files:[],isFirstLineTitle:!1,isFirstLineRemove:!0,isClearFormat:!0,isFirstLineIndent:!0,isClearFontSize:!0,isClearFontFamily:!0,isClearImages:!1,checkedLevels:null,checkedLevel:null},methods={loadConfig:function(){var e=this;e.pageLoad=!0,$api.get({siteId:e.siteId,channelId:e.channelId},function(t,i){!t&&i&&i.value&&(e.checkedLevels=i.value,e.checkedLevel=i.checkedLevel,e.loadUploader())})},loadUploader:function(){var e=this,t=Q.event,i=Q.Uploader,a=document.getElementById("drop-area"),n=new i({url:$uploadUrl+"/actions/upload?siteId="+e.siteId+"&channelId="+e.channelId,target:document.getElementById("drop-area"),allows:".doc,.docx",on:{add:function(e){if(e.disabled)return alert({title:"允许上传的文件格式为："+this.ops.allows,type:"warning",confirmButtonText:"关 闭"})},complete:function(t){var i=t.json;if(!i||1!=i.ret)return alert({title:"上传失败！",type:"warning",confirmButtonText:"关 闭"});i&&i.fileName&&e.files.push(i)}}});i.support.html5&&n.html5?(t.add(a,"dragleave",t.stop),t.add(a,"dragenter",t.stop),t.add(a,"dragover",t.stop),t.add(a,"drop",function(e){t.stop(e);var i=e.dataTransfer.files;n.addList(i)})):a.innerHTML="点击批量上传Word文件"},del:function(e){this.files.splice(this.files.indexOf(e),1)},getFileNames:function(){for(var e=[],t=0;t<this.files.length;t++)e.push(this.files[t].fileName);return e},btnSubmitClick:function(){var e=this,t=this.getFileNames().join(",");if(!t)return alert({title:"请选择需要导入的Word文件！",type:"warning",showConfirmButton:"关 闭"});pageUtils.loading(!0),$api.post({siteId:e.siteId,channelId:e.channelId,isFirstLineTitle:e.isFirstLineTitle,isFirstLineRemove:e.isFirstLineRemove,isClearFormat:e.isClearFormat,isFirstLineIndent:e.isFirstLineIndent,isClearFontSize:e.isClearFontSize,isClearFontFamily:e.isClearFontFamily,isClearImages:e.isClearImages,checkedLevel:e.checkedLevel,fileNames:t},function(t,i){if(!t&&i&&i.value){var a=i.value;1===a.length?parent.location.href="pageContentAdd.aspx?siteId="+e.siteId+"&channelId="+e.channelId+"&id="+a[0]:parent.location.reload(!0)}})}};new Vue({el:"#main",data:data,methods:methods,created:function(){this.loadConfig()}});
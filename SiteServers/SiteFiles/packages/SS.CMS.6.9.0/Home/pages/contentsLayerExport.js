var $api=new utils.Api("/home/contentsLayerExport"),data={siteId:parseInt(utils.getQueryString("siteId")),channelId:parseInt(utils.getQueryString("channelId")),pageLoad:!1,pageAlert:null,columns:null,checkedLevels:null,checkedLevel:null,exportType:"zip",isAllCheckedLevel:!0,checkedLevelKeys:[],isAllDate:!0,startDate:new Date((new Date).setDate((new Date).getDate()-30)),endDate:new Date,isAllColumns:!1,columnNames:[]},methods={loadConfig:function(){var e=this;$api.get({siteId:e.siteId,channelId:e.channelId},function(l,t){if(!l&&t&&t.value){e.columns=t.value,e.columnNames=[];for(var s=0;s<e.columns.length;s++){var n=e.columns[s];n.isList&&e.columnNames.push(n.attributeName)}e.checkedLevels=t.checkedLevels;for(s=0;s<e.checkedLevels.length;s++){var a=e.checkedLevels[s];e.checkedLevelKeys.push(a.key)}e.checkedLevel=t.checkedLevel,e.pageLoad=!0}})},btnIsAllCheckedLevelClick:function(){if(this.isAllCheckedLevel=!this.isAllCheckedLevel,this.checkedLevelKeys=[],this.isAllCheckedLevel)for(var e=0;e<this.checkedLevels.length;e++){var l=this.checkedLevels[e];this.checkedLevelKeys.push(l.key)}},btnIsAllColumnsClick:function(){if(this.isAllColumns=!this.isAllColumns,this.columnNames=["Title"],this.isAllColumns)for(var e=0;e<this.columns.length;e++){var l=this.columns[e];this.columnNames.push(l.attributeName)}},btnSubmitClick:function(){var e=this;if(this.pageAlert=null,0===this.checkedLevelKeys.length)return this.pageAlert={type:"danger",html:"必须至少选择一项内容状态"};parent.utils.loading(!0),$api.post({siteId:e.siteId,channelId:e.channelId,exportType:e.exportType,isAllCheckedLevel:e.isAllCheckedLevel,checkedLevelKeys:e.checkedLevelKeys,isAllDate:e.isAllDate,startDate:e.startDate,endDate:e.endDate,columnNames:e.columnNames},function(l,t){return parent.utils.loading(!1),l?e.pageAlert={type:"danger",html:t.message}:t.isSuccess?(window.open(t.value),void parent.layer.closeAll()):e.pageAlert={type:"danger",html:"没有符合条件的内容，请重新选择导出条件"}})}};Vue.component("date-picker",window.DatePicker.default),new Vue({el:"#main",data:data,methods:methods,created:function(){this.loadConfig()}});
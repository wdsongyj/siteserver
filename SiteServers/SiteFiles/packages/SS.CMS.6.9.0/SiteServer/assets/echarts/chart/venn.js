define("echarts/chart/venn",["require","./base","zrender/shape/Text","zrender/shape/Circle","zrender/shape/Path","../config","../util/ecData","zrender/tool/util","../chart"],function(e){function t(e,t,a,i,r){s.call(this,e,t,a,i,r),this.refresh(i)}var s=e("./base"),a=e("zrender/shape/Text"),i=e("zrender/shape/Circle"),r=e("zrender/shape/Path"),h=e("../config");h.venn={zlevel:0,z:1,calculable:!1};var l=e("../util/ecData"),n=e("zrender/tool/util");return t.prototype={type:h.CHART_TYPE_VENN,_buildShape:function(){this.selectedMap={},this._symbol=this.option.symbolList,this._queryTarget,this._dropBoxList=[],this._vennDataCounter=0;for(var e=this.series,t=this.component.legend,s=0;s<e.length;s++)if(e[s].type===h.CHART_TYPE_VENN){e[s]=this.reformOption(e[s]);var a=e[s].name||"";if(this.selectedMap[a]=!t||t.isSelected(a),!this.selectedMap[a])continue;this._buildVenn(s)}this.addShapeList()},_buildVenn:function(e){var t,s,a=this.series[e].data;a[0].value>a[1].value?s=(t=this.zr.getHeight()/3)*Math.sqrt(a[1].value)/Math.sqrt(a[0].value):t=(s=this.zr.getHeight()/3)*Math.sqrt(a[0].value)/Math.sqrt(a[1].value);var i=this.zr.getWidth()/2-t,r=(t+s)/2*Math.sqrt(a[2].value)/Math.sqrt((a[0].value+a[1].value)/2),h=t+s;0!==a[2].value&&(h=this._getCoincideLength(a[0].value,a[1].value,a[2].value,t,s,r,Math.abs(t-s),t+s));var l=i+h,n=this.zr.getHeight()/2;if(this._buildItem(e,0,a[0],i,n,t),this._buildItem(e,1,a[1],l,n,s),0!==a[2].value&&a[2].value!==a[0].value&&a[2].value!==a[1].value){var o=(t*t-s*s)/(2*h)+h/2,c=h/2-(t*t-s*s)/(2*h),u=Math.sqrt(t*t-o*o),p=0,f=0;a[0].value>a[1].value&&i+o>l&&(f=1),a[0].value<a[1].value&&i+c>l&&(p=1),this._buildCoincideItem(e,2,a[2],i+o,n-u,n+u,t,s,p,f)}},_getCoincideLength:function(e,t,s,a,i,r,h,l){var n=(a*a-i*i)/(2*r)+r/2,o=r/2-(a*a-i*i)/(2*r),c=Math.acos(n/a),u=Math.acos(o/i),p=a*a*Math.PI,f=(c*a*a-n*a*Math.sin(c)+u*i*i-o*i*Math.sin(u))/p,v=s/e,b=Math.abs(f/v);return b>.999&&1.001>b?r:.999>=b?(l=r,r=(r+h)/2,this._getCoincideLength(e,t,s,a,i,r,h,l)):(h=r,r=(r+l)/2,this._getCoincideLength(e,t,s,a,i,r,h,l))},_buildItem:function(e,t,s,a,i,r){var h=this.series[e],n=this.getCircle(e,t,s,a,i,r);if(l.pack(n,h,e,s,t,s.name),this.shapeList.push(n),h.itemStyle.normal.label.show){var o=this.getLabel(e,t,s,a,i,r);l.pack(o,h,e,h.data[t],t,h.data[t].name),this.shapeList.push(o)}},_buildCoincideItem:function(e,t,s,a,i,h,n,o,c,u){var p=this.series,f=p[e],v=[s,f],b=this.deepMerge(v,"itemStyle.normal")||{},d=this.deepMerge(v,"itemStyle.emphasis")||{},g=b.color||this.zr.getColor(t),m=d.color||this.zr.getColor(t),M={color:g,path:"M"+a+","+i+"A"+n+","+n+",0,"+c+",1,"+a+","+h+"A"+o+","+o+",0,"+u+",1,"+a+","+i},y={zlevel:f.zlevel,z:f.z,style:M,highlightStyle:{color:m,lineWidth:d.borderWidth,strokeColor:d.borderColor}};(y=new r(y)).buildPathArray&&(y.style.pathArray=y.buildPathArray(M.path)),l.pack(y,p[e],0,s,t,s.name),this.shapeList.push(y)},getCircle:function(e,t,s,a,r,h){var l=this.series[e],n=[s,l],o=this.deepMerge(n,"itemStyle.normal")||{},c=this.deepMerge(n,"itemStyle.emphasis")||{},u=o.color||this.zr.getColor(t),p=c.color||this.zr.getColor(t),f={zlevel:l.zlevel,z:l.z,clickable:!0,style:{x:a,y:r,r:h,brushType:"fill",opacity:1,color:u},highlightStyle:{color:p,lineWidth:c.borderWidth,strokeColor:c.borderColor}};return this.deepQuery([s,l,this.option],"calculable")&&(this.setCalculable(f),f.draggable=!0),new i(f)},getLabel:function(e,t,s,i,r,h){var l=this.series[e],n=l.itemStyle,o=[s,l],c=this.deepMerge(o,"itemStyle.normal")||{},u="normal",p=n[u].label.textStyle||{},f=this.getLabelText(t,s,u),v=this.getFont(p),b=c.color||this.zr.getColor(t),d=p.fontSize||12,g={zlevel:l.zlevel,z:l.z,style:{x:i,y:r-h-d,color:p.color||b,text:f,textFont:v,textAlign:"center"}};return new a(g)},getLabelText:function(e,t,s){var a=this.series[0],i=this.deepQuery([t,a],"itemStyle."+s+".label.formatter");return i?"function"==typeof i?i(a.name,t.name,t.value):"string"==typeof i?i=(i=i.replace("{a}","{a0}").replace("{b}","{b0}").replace("{c}","{c0}")).replace("{a0}",a.name).replace("{b0}",t.name).replace("{c0}",t.value):void 0:t.name},refresh:function(e){e&&(this.option=e,this.series=e.series),this._buildShape()}},n.inherits(t,s),e("../chart").define("venn",t),t}),define("zrender/shape/Path",["require","./Base","./util/PathProxy","../tool/util"],function(e){var t=e("./Base"),s=e("./util/PathProxy").PathSegment,a=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},i=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(a(e)*a(t))},r=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(i(e,t))},h=function(e){t.call(this,e)};return h.prototype={type:"path",buildPathArray:function(e,t,a){if(!e)return[];t=t||0,a=a||0;var i,r=e,h=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];for(r=(r=(r=(r=r.replace(/-/g," -")).replace(/  /g," ")).replace(/ /g,",")).replace(/,,/g,","),i=0;i<h.length;i++)r=r.replace(new RegExp(h[i],"g"),"|"+h[i]);var l=r.split("|"),n=[],o=0,c=0;for(i=1;i<l.length;i++){var u=l[i],p=u.charAt(0),f=(u=(u=u.slice(1)).replace(new RegExp("e,-","g"),"e-")).split(",");f.length>0&&""===f[0]&&f.shift();for(var v=0;v<f.length;v++)f[v]=parseFloat(f[v]);for(;f.length>0&&!isNaN(f[0]);){var b,d,g,m,M,y,z,_,C=null,A=[],L=o,k=c;switch(p){case"l":o+=f.shift(),c+=f.shift(),C="L",A.push(o,c);break;case"L":o=f.shift(),c=f.shift(),A.push(o,c);break;case"m":o+=f.shift(),c+=f.shift(),C="M",A.push(o,c),p="l";break;case"M":o=f.shift(),c=f.shift(),C="M",A.push(o,c),p="L";break;case"h":o+=f.shift(),C="L",A.push(o,c);break;case"H":o=f.shift(),C="L",A.push(o,c);break;case"v":c+=f.shift(),C="L",A.push(o,c);break;case"V":c=f.shift(),C="L",A.push(o,c);break;case"C":A.push(f.shift(),f.shift(),f.shift(),f.shift()),o=f.shift(),c=f.shift(),A.push(o,c);break;case"c":A.push(o+f.shift(),c+f.shift(),o+f.shift(),c+f.shift()),o+=f.shift(),c+=f.shift(),C="C",A.push(o,c);break;case"S":b=o,d=c,"C"===(g=n[n.length-1]).command&&(b=o+(o-g.points[2]),d=c+(c-g.points[3])),A.push(b,d,f.shift(),f.shift()),o=f.shift(),c=f.shift(),C="C",A.push(o,c);break;case"s":b=o,d=c,"C"===(g=n[n.length-1]).command&&(b=o+(o-g.points[2]),d=c+(c-g.points[3])),A.push(b,d,o+f.shift(),c+f.shift()),o+=f.shift(),c+=f.shift(),C="C",A.push(o,c);break;case"Q":A.push(f.shift(),f.shift()),o=f.shift(),c=f.shift(),A.push(o,c);break;case"q":A.push(o+f.shift(),c+f.shift()),o+=f.shift(),c+=f.shift(),C="Q",A.push(o,c);break;case"T":b=o,d=c,"Q"===(g=n[n.length-1]).command&&(b=o+(o-g.points[0]),d=c+(c-g.points[1])),o=f.shift(),c=f.shift(),C="Q",A.push(b,d,o,c);break;case"t":b=o,d=c,"Q"===(g=n[n.length-1]).command&&(b=o+(o-g.points[0]),d=c+(c-g.points[1])),o+=f.shift(),c+=f.shift(),C="Q",A.push(b,d,o,c);break;case"A":m=f.shift(),M=f.shift(),y=f.shift(),z=f.shift(),_=f.shift(),L=o,k=c,o=f.shift(),c=f.shift(),C="A",A=this._convertPoint(L,k,o,c,z,_,m,M,y);break;case"a":m=f.shift(),M=f.shift(),y=f.shift(),z=f.shift(),_=f.shift(),L=o,k=c,o+=f.shift(),c+=f.shift(),C="A",A=this._convertPoint(L,k,o,c,z,_,m,M,y)}for(var P=0,N=A.length;N>P;P+=2)A[P]+=t,A[P+1]+=a;n.push(new s(C||p,A))}("z"===p||"Z"===p)&&n.push(new s("z",[]))}return n},_convertPoint:function(e,t,s,a,h,l,n,o,c){var u=c*(Math.PI/180),p=Math.cos(u)*(e-s)/2+Math.sin(u)*(t-a)/2,f=-1*Math.sin(u)*(e-s)/2+Math.cos(u)*(t-a)/2,v=p*p/(n*n)+f*f/(o*o);v>1&&(n*=Math.sqrt(v),o*=Math.sqrt(v));var b=Math.sqrt((n*n*o*o-n*n*f*f-o*o*p*p)/(n*n*f*f+o*o*p*p));h===l&&(b*=-1),isNaN(b)&&(b=0);var d=b*n*f/o,g=b*-o*p/n,m=(e+s)/2+Math.cos(u)*d-Math.sin(u)*g,M=(t+a)/2+Math.sin(u)*d+Math.cos(u)*g,y=r([1,0],[(p-d)/n,(f-g)/o]),z=[(p-d)/n,(f-g)/o],_=[(-1*p-d)/n,(-1*f-g)/o],C=r(z,_);return i(z,_)<=-1&&(C=Math.PI),i(z,_)>=1&&(C=0),0===l&&C>0&&(C-=2*Math.PI),1===l&&0>C&&(C+=2*Math.PI),[m,M,n,o,y,C,u,l]},buildPath:function(e,t){var s=t.path,a=t.x||0,i=t.y||0;t.pathArray=t.pathArray||this.buildPathArray(s,a,i);for(var r=t.pathArray,h=t.pointList=[],l=[],n=0,o=r.length;o>n;n++){"M"==r[n].command.toUpperCase()&&(l.length>0&&h.push(l),l=[]);for(var c=0,u=(f=r[n].points).length;u>c;c+=2)l.push([f[c],f[c+1]])}l.length>0&&h.push(l);for(n=0,o=r.length;o>n;n++){var p=r[n].command,f=r[n].points;switch(p){case"L":e.lineTo(f[0],f[1]);break;case"M":e.moveTo(f[0],f[1]);break;case"C":e.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":e.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":var v=f[0],b=f[1],d=f[2],g=f[3],m=f[4],M=f[5],y=f[6],z=f[7],_=d>g?d:g,C=d>g?1:d/g,A=d>g?g/d:1;e.translate(v,b),e.rotate(y),e.scale(C,A),e.arc(0,0,_,m,m+M,1-z),e.scale(1/C,1/A),e.rotate(-y),e.translate(-v,-b);break;case"z":e.closePath()}}},getRect:function(e){if(e.__rect)return e.__rect;var t,s;t="stroke"==e.brushType||"fill"==e.brushType?e.lineWidth||1:0;for(var a=Number.MAX_VALUE,i=Number.MIN_VALUE,r=Number.MAX_VALUE,h=Number.MIN_VALUE,l=e.x||0,n=e.y||0,o=e.pathArray||this.buildPathArray(e.path),c=0;c<o.length;c++)for(var u=o[c].points,p=0;p<u.length;p++)p%2==0?(u[p]+l<a&&(a=u[p]),u[p]+l>i&&(i=u[p])):(u[p]+n<r&&(r=u[p]),u[p]+n>h&&(h=u[p]));return s=a===Number.MAX_VALUE||i===Number.MIN_VALUE||r===Number.MAX_VALUE||h===Number.MIN_VALUE?{x:0,y:0,width:0,height:0}:{x:Math.round(a-t/2),y:Math.round(r-t/2),width:i-a+t,height:h-r+t},e.__rect=s,s}},e("../tool/util").inherits(h,t),h});